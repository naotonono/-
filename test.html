<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Health care site</title>
    <meta name="description" content="è‡ªå®¶ç„™ç…ã—ãŸã“ã ã‚ã‚Šã®ã‚³ãƒ¼ãƒ’ãƒ¼ã¨ã€æ€ã‚ãšé•·å±…ã—ãŸããªã‚‹ã‚ˆã†ãªå±…å¿ƒåœ°ã®è‰¯ã„ç©ºé–“ã‚’æä¾›ã™ã‚‹ã‚«ãƒ•ã‚§ã€ŒKISSAã€ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã§ã™ã€‚">
    <meta name="viewport" content="width=device-width">
    <script src="./js/toggle-menu.js"></script>
    <link href="./css/common.css" rel="stylesheet">
    <link href="./css/index.css" rel="stylesheet">
    <style>
        /* é£Ÿäº‹è¨˜éŒ²ãƒ•ã‚©ãƒ¼ãƒ ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .meal-container {
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
            background-color: #f4f4f4;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .meal-container h2 {
            text-align: center;
        }

        .meal-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .meal-form label {
            font-weight: bold;
            font-size: 18px; /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹ */
        }

        .meal-form textarea,
        .meal-form input {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }

        .meal-form button {
            padding: 10px;
            background-color: #02ebeb; /* ãƒœã‚¿ãƒ³ã®èƒŒæ™¯è‰² */
            color: white;
            border: 2px solid #02ebeb; /* ãƒœã‚¿ãƒ³ã®æ ç·šã®è‰² */
            border-radius: 30px; /* ãƒœã‚¿ãƒ³ã®è§’ã‚’ä¸¸ãã™ã‚‹ */
            font-size: 21px; /* ãƒœã‚¿ãƒ³ã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹ */
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s; /* ãƒ›ãƒãƒ¼æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        }

        .meal-form button:hover {
            background-color: white; /* ãƒ›ãƒãƒ¼æ™‚ã®èƒŒæ™¯è‰² */
            color: #02ebeb; /* ãƒ›ãƒãƒ¼æ™‚ã®æ–‡å­—è‰² */
            border-color: #02ebeb; /* ãƒ›ãƒãƒ¼æ™‚ã®æ ç·šã®è‰² */
        }

        #result {
            margin-top: 20px;
        }

        .meal-image-preview img {
            max-width: 100%;
            margin-top: 10px;
        }

        .camera-button {
            background-color: #008CBA; /* ã‚«ãƒ¡ãƒ©ãƒœã‚¿ãƒ³ã®è‰² */
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .camera-button:hover {
            background-color: #007B9A; /* ãƒ›ãƒãƒ¼æ™‚ã®è‰² */
        }
        #savedMeals {
            margin-top: 30px;
        }
        .saved-meal {
            border-top: 1px solid #ddd;
            padding-top: 10px;
            margin-top: 10px;
        }
        .saved-meal img {
            max-width: 100px;
            margin-top: 10px;
            display: block;
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="header-inner">
            <a class="header-logo" href="./test.html">
                <img src="images/header/Image.png" alt="KISSA">
                
            </a>
            <h1></h1>
            <button class="toggle-menu-button"></button>
            <div class="header-site-menu">
                <nav class="site-menu">
                    <ul>
                        <li><a href="/karenda.html">ä½“é‡ã¨ä½“è„‚è‚ªç®¡ç†ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a></li>
                        <li><a href="./nikki3.html">é£Ÿäº‹è¨˜éŒ²</a></li>
                        <li><a href="bmi.html">BMIã®è¨ˆç®—</a></li>
                        <li><a href="./contact-form/">FORM</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    <main class="main">
        <div class="first-view">
            <div class="first-view-text">
                <h1>è‡ªåˆ†ã®å¥åº·ã‚’è¨˜éŒ²ã§ãã‚‹ã‚µã‚¤ãƒˆ <br>Health care.</h1>
                <p>å¥åº·å¯¿å‘½ã‚’å»¶ã°ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
                <div class="link-button-area">
                    <a class="link-button" href="\karenda.html">START</a>
                </div>
            </div>
        </div>

        <div class="meal-container">
           

            <h2>é£Ÿäº‹è¨˜éŒ²</h2>
            <form id="mealForm" class="meal-form">
                
                <label for="mealDate">æ—¥ä»˜:</label>
                <input type="date" id="mealDate" required>
                <!-- æœé£Ÿ -->
                <label for="breakfast">æœé£Ÿ:</label>
                <textarea id="breakfast" name="breakfast" rows="2" placeholder="æœé£Ÿã«é£Ÿã¹ãŸã‚‚ã®ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„"></textarea>
                <input type="file" id="breakfastImage" accept="image/*" style="display:none;">
                <button type="button" class="camera-button" onclick="document.getElementById('breakfastImage').click()">å†™çœŸã‚’æ’®ã‚‹ğŸ“·</button>
                <div class="meal-image-preview" id="breakfastImagePreview"></div>

                <!-- æ˜¼é£Ÿ -->
                <label for="lunch">æ˜¼é£Ÿ:</label>
                <textarea id="lunch" name="lunch" rows="2" placeholder="æ˜¼é£Ÿã«é£Ÿã¹ãŸã‚‚ã®ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„"></textarea>
                <input type="file" id="lunchImage" accept="image/*" style="display:none;">
                <button type="button" class="camera-button" onclick="document.getElementById('lunchImage').click()">å†™çœŸã‚’æ’®ã‚‹ğŸ“·</button>
                <div class="meal-image-preview" id="lunchImagePreview"></div>

                <!-- å¤•é£Ÿ -->
                <label for="dinner">å¤•é£Ÿ:</label>
                <textarea id="dinner" name="dinner" rows="2" placeholder="å¤•é£Ÿã«é£Ÿã¹ãŸã‚‚ã®ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„"></textarea>
                <input type="file" id="dinnerImage" accept="image/*" style="display:none;">
                <button type="button" class="camera-button" onclick="document.getElementById('dinnerImage').click()">å†™çœŸã‚’æ’®ã‚‹ğŸ“·</button>
                <div class="meal-image-preview" id="dinnerImagePreview"></div>

                <!-- é–“é£Ÿ -->
                <label for="snacks">é–“é£Ÿ:</label>
                <textarea id="snacks" name="snacks" rows="2" placeholder="é–“é£Ÿã«é£Ÿã¹ãŸã‚‚ã®ã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„"></textarea>
                <input type="file" id="snacksImage" accept="image/*" style="display:none;">
                <button type="button" class="camera-button" onclick="document.getElementById('snacksImage').click()">å†™çœŸã‚’æ’®ã‚‹ğŸ“·</button>
                <div class="meal-image-preview" id="snacksImagePreview"></div>

                <button type="submit">è¨˜éŒ²ã‚’ä¿å­˜</button> <!-- ä¿å­˜ãƒœã‚¿ãƒ³ -->
            </form>
            <div id="savedMeals"></div>
        </div>

        <div id="result"></div>

        <div class="lead">
            <p></p>
            <div class="link-button-area">
                <a class="link-button" href=",/concept.html">ãƒ­ã‚°ã‚¤ãƒ³</a>
            </div>
        </div>
        <div class="recommended">
            <h2>RECOMMENDED</h2>
            <div class="link-button-area">
                <a class="link-button" href=",/menu.html">menu</a>
            </div>
        </div>
    </main>

    <footer class="footer">
        <nav class="site-menu">
            <ul>
                <li><a href="./concept.html">CONCEPT</a></li>
                <li><a href="./menu.html">MENU</a></li>
                <li><a href="./SHOP.html">SHOP</a></li>
                <li><a href="./ACCESS.html">ACCESS</a></li>
            </ul>
        </nav>
        <a class="footer-logo" href="./index.html">
            <img src="./images/common/logo-footer.png" alt="KISSA">
        </a>
        <p class="footer-tel">TEL 01-2345-6789</p>
        <p class="footer-time">OPEN Fri-Sun 11:00-16:00</p>
        <p class="copyright"><small>&copy;Kissa</small></p>
    </footer>

        <!-- ä¿å­˜ã—ãŸè¨˜éŒ²ã‚’è¡¨ç¤ºã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
         <div id="SavedMeals"></div>
    

<script>
  
  function setTodayDate() {
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0'); // æœˆã¯0ã‹ã‚‰å§‹ã¾ã‚‹ãŸã‚+1
    const dd = String(today.getDate()).padStart(2, '0');
    const formattedDate = `${yyyy}-${mm}-${dd}`;
    document.getElementById("mealDate").value = formattedDate;
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«æ—¥ä»˜ã‚’ä»Šæ—¥ã®æ—¥ä»˜ã«è¨­å®š
window.onload = function () {
    setTodayDate();
    displaySavedMeals();
};

    // ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®è¡¨ç¤º
    function setupImagePreview(inputId, previewId) {
        document.getElementById(inputId).addEventListener("change", function (event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const imgPreview = document.getElementById(previewId);
                    imgPreview.innerHTML = '<img src="' + e.target.result + '" alt="é£Ÿäº‹ã®å†™çœŸ">';
                };
                reader.readAsDataURL(file);
            }
        });
    }

    setupImagePreview("breakfastImage", "breakfastImagePreview");
    setupImagePreview("lunchImage", "lunchImagePreview");
    setupImagePreview("dinnerImage", "dinnerImagePreview");
    setupImagePreview("snacksImage", "snacksImagePreview");

    // ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’Base64ã«å¤‰æ›ã—ã¦ä¿å­˜
    function getBase64Image(file, callback) {
        if (!file) {
            // ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã€ç©ºæ–‡å­—åˆ—ã‚’ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«æ¸¡ã™
            callback("");
            return;
        }
        const reader = new FileReader();
        reader.onloadend = function () {
            callback(reader.result);
        };
        reader.readAsDataURL(file);
    }

    
    // ä¿å­˜å‡¦ç†
    document.getElementById("mealForm").addEventListener("submit", function (event) {
        event.preventDefault(); // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«

        const mealDate = document.getElementById("mealDate").value;
        const breakfast = document.getElementById("breakfast").value;
        const lunch = document.getElementById("lunch").value;
        const dinner = document.getElementById("dinner").value;
        const snacks = document.getElementById("snacks").value;

        // å„ç”»åƒã‚’å–å¾—
        const breakfastImageFile = document.getElementById("breakfastImage").files[0];
        const lunchImageFile = document.getElementById("lunchImage").files[0];
        const dinnerImageFile = document.getElementById("dinnerImage").files[0];
        const snacksImageFile = document.getElementById("snacksImage").files[0];

        // ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’Base64ã«å¤‰æ›ã—ã¦ä¿å­˜
        getBase64Image(breakfastImageFile, function (breakfastImageBase64) {
            getBase64Image(lunchImageFile, function (lunchImageBase64) {
                getBase64Image(dinnerImageFile, function (dinnerImageBase64) {
                    getBase64Image(snacksImageFile, function (snacksImageBase64) {

                        const mealData = {
                            date: mealDate,
                            breakfast: breakfast,
                            breakfastImage: breakfastImageBase64 || "",
                            lunch: lunch,
                            lunchImage: lunchImageBase64 || "",
                            dinner: dinner,
                            dinnerImage: dinnerImageBase64 || "",
                            snacks: snacks,
                            snacksImage: snacksImageBase64 || ""
                        };

                        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
                        const mealRecords = JSON.parse(localStorage.getItem('mealRecords')) || {};
                        mealRecords[mealDate] = mealData;
                        localStorage.setItem('mealRecords', JSON.stringify(mealRecords));

                        alert("é£Ÿäº‹è¨˜éŒ²ãŒä¿å­˜ã•ã‚Œã¾ã—ãŸï¼");

                        // ä¿å­˜å¾Œã€è¨˜éŒ²è¡¨ç¤ºã‚’æ›´æ–°
                        displaySavedMeals();
                    });
                });
            });
        });
    });

        
    // ä¿å­˜ã•ã‚ŒãŸé£Ÿäº‹è¨˜éŒ²ã‚’è¡¨ç¤ºã™ã‚‹
    function displaySavedMeals() {
        const savedMealsContainer = document.getElementById("savedMeals");
        savedMealsContainer.innerHTML = ""; // ä»¥å‰ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢
        const mealRecords = JSON.parse(localStorage.getItem('mealRecords')) || {};
        
        for (const date in mealRecords) {
            const mealData = mealRecords[date];
            const mealHtml = `
                <div class="saved-meal">
                    <h3>${date}</h3>
                    <p><strong>æœé£Ÿ:</strong> ${mealData.breakfast}</p>
                    ${mealData.breakfastImage ? `<img src="${mealData.breakfastImage}" alt="æœé£Ÿã®å†™çœŸ">` : ''}
                    <p><strong>æ˜¼é£Ÿ:</strong> ${mealData.lunch}</p>
                    ${mealData.lunchImage ? `<img src="${mealData.lunchImage}" alt="æ˜¼é£Ÿã®å†™çœŸ">` : ''}
                    <p><strong>å¤•é£Ÿ:</strong> ${mealData.dinner}</p>
                    ${mealData.dinnerImage ? `<img src="${mealData.dinnerImage}" alt="å¤•é£Ÿã®å†™çœŸ">` : ''}
                    <p><strong>é–“é£Ÿ:</strong> ${mealData.snacks}</p>
                    ${mealData.snacksImage ? `<img src="${mealData.snacksImage}" alt="é–“é£Ÿã®å†™çœŸ">` : ''}
                </div>
            `;
            savedMealsContainer.innerHTML += mealHtml;
        }
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä¿å­˜ã•ã‚ŒãŸè¨˜éŒ²ã‚’è¡¨ç¤º
    window.onload = function () {
        displaySavedMeals();
        
    };
   
</script>

</body>

</html>
